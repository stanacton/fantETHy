var app=angular.module("fantethy",["ngRoute"]);app.controller("GameCreateCtrl",["$scope","GameSvc",function(a,b){a.item={},a.create=function(c){if(a.errors=[],c.name||a.errors.push({message:"Name is required."}),c.nickname||a.errors.push({message:"Nickname is required."}),c.leagueSize||a.errors.push({message:"League Size is required."}),c.buyIn||a.errors.push({message:"Buy In is required."}),!(a.errors.length>0)){var d=b.createGame(c);"success"===d.status?(a.success=!0,a.address=d.address):console.log("The error was: ",d)}}}]),app.controller("GameCtrl",["$scope","GameSvc","$routeParams",function(a,b,c){a.game=b.getGame(c.id)}]),app.controller("GameJoinCtrl",["$scope",function(a){a.game={name:"Andy's Game #1",buyIn:33,address:"0x02332423423a9df0a9a9afas0s99977688ad8",type:"Winner Takes All",isPrivate:!1},a.join=function(){a.success=!0}}]),app.controller("GamesListCtrl",["$scope",function(a){a.games=[{buyIn:3,address:"0x12423596843e32f32af333",type:"WINNER_TAKES_ALL",name:"Andy's Game #1"},{buyIn:10,address:"0x12423596843e32f32af333",type:"WINNER_TAKES_ALL",name:"Andy's Game #2"},{buyIn:15,address:"0x12423596843e32f32af333",type:"WINNER_TAKES_ALL",name:"Andy's Game #3"},{buyIn:15,address:"0x12423596843e32f32af333",type:"WINNER_TAKES_ALL",name:"Pinky's Game #3"},{buyIn:15,address:"0x12423596843e32f32af333",type:"WINNER_TAKES_ALL",name:"The Brain's Game #3"}],a.join=function(a){var b="#/games/"+a.address;window.location.href=b}}]),app.controller("HomeCtrl",["$scope","AngWeb3",function(a,b){}]),app.controller("MyGamesCtrl",["$scope",function(a){a.games=[{rank:10,buyIn:33,address:"0x12423596843e32f32af333",type:"WINNER_TAKES_ALL",name:"Andy's Game #1",status:"DRAFT"},{rank:3,buyIn:1,address:"0x12423596843e32f32af333",type:"WINNER_TAKES_ALL",name:"The Brain's Game #3",status:"Session In Progress"}]}]),app.controller("SelectTeamCtrl",["$scope","$routeParams","PlayersSvc",function(a,b,c){function d(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.name===b.name)return void console.log("Already added.")}a.push(b)}a.max={maxForwards:2,maxMidField:4,maxDefender:4,maxGoalkeeper:1},a.team={forwards:[],midfield:[],defender:[],goalkeeper:[]},c.getPlayers().success(function(b){a.players=b}),a.addForward=function(b){a.team.forwards.length<a.max.maxForwards&&d(a.team.forwards,b)},a.addKeeper=function(b){a.team.goalkeeper.length<a.max.maxGoalkeeper&&d(a.team.goalkeeper,b)},a.addMidfield=function(b){a.team.midfield.length<a.max.maxMidField&&d(a.team.midfield,b)},a.addDefender=function(b){a.team.defender.length<a.max.maxDefender&&d(a.team.defender,b)},a.moveUp=function(b,c){var d=a.team[b].indexOf(c);if(console.log("index",d),d>0){a.team[b].splice(d,1);var e=d-1;a.team[b].splice(e,0,c)}},a.moveDown=function(b,c){var d=a.team[b].indexOf(c);if(console.log("index",d),d<a.team[b].length){a.team[b].splice(d,1);var e=d+1;a.team[b].splice(e,0,c)}},a.remove=function(b,c){var d=a.team[b].indexOf(c);d<a.team[b].length&&a.team[b].splice(d,1)},a.save=function(){if(a.errors=[],a.team.goalkeeper.length!==a.max.maxGoalkeeper&&a.errors.push({message:"You require "+a.max.maxGoalkeeper+" goal keepers."}),a.team.forwards.length!==a.max.maxForwards&&a.errors.push({message:"You require "+a.max.maxForwards+" forwards."}),a.team.midfield.length!==a.max.maxMidField&&a.errors.push({message:"You require "+a.max.maxMidField+" midfielders."}),a.team.defender.length!==a.max.maxDefender&&a.errors.push({message:"You require "+a.max.maxDefender+" defenders."}),!(a.errors.length>0)){var d=b.id,e=a.team;e.leagueAddress=d;var f=c.savePlayers(e);"success"===f.status?window.location.href="#/game/"+d:a.errors.push({message:"There was an error. "+f.error.message})}}}]),app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/home",{templateUrl:"partials/home.html",controller:"HomeCtrl"}).when("/games",{templateUrl:"partials/games-list.html",controller:"GamesListCtrl"}).when("/my-games",{templateUrl:"partials/games-mine.html",controller:"MyGamesCtrl"}).when("/games/join/:id",{templateUrl:"partials/game-join.html",controller:"GameJoinCtrl"}).when("/game/create",{templateUrl:"partials/game-create.html",controller:"GameCreateCtrl"}).when("/game/:id/select-team",{templateUrl:"partials/select-team.html",controller:"SelectTeamCtrl"}).when("/game/:id",{templateUrl:"partials/game.html",controller:"GameCtrl"}).otherwise({redirectTo:"/home"})}]),function(a,b){b.factory("AngWeb3",["WalletBar",function(b){var c=new a,d=b.getHook("edgeware");return console.log("Hook",d),d?c.setProvider(b.getHook("edgware")):c=new a("undefined"!=typeof c?c.currentProvider:new a.providers.HttpProvider("http://localhost:8545")),c}])}(Web3,app),app.factory("GameSvc",["AngWeb3","WalletBar","$http",function(a,b,c){function d(a){var b=(f.at(a),[{name:"Ronaldo"},{name:"Andre Gray"}]),c={address:"0xda3323f2332f32f32f23f32f",weeksRemaining:4,name:"Andy's Premiership",status:"Season in Progress",prizePool:34,users:[{rank:3,name:"Andy",points:345,address:"0x44asa097fad6fdfs9s87f9s7f97a7f7af7e9f7a89a7f9a",players:b},{rank:4,name:"Chris",points:245,address:"0x44asa097fad6fdfs9s87f9s7f97a7f7af7e9f7a89a7f9a",players:b},{rank:2,name:"Coleman",points:45,address:"0x44asa097fad6fdfs9s87f9s7f97a7f7af7e9f7a89a7f9a",players:b},{rank:1,name:"Acton",points:5,address:"0x44asa097fad6fdfs9s87f9s7f97a7f7af7e9f7a89a7f9a",players:b}]};return c}function e(a){return{status:"success",address:"0x23423423423423423423423423423423423423423423423423"}}var f=a.eth.contract([{constant:!1,inputs:[],name:"getStatus",outputs:[{name:"",type:"uint8"}],payable:!1,type:"function"},{constant:!1,inputs:[],name:"fetchTeamByID",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[],name:"joinLeague",outputs:[{name:"",type:"bool"}],payable:!1,type:"function"},{inputs:[{name:"name",type:"string"},{name:"setBuyIn",type:"uint256"}],type:"constructor"}]);return{getGame:d,createGame:e}}]),app.factory("PlayersSvc",["$http",function(a){function b(){return a.get("javascripts/data/players.json")}function c(a){return{status:"success"}}return{getPlayers:b,savePlayers:c}}]),app.factory("WalletBar",[function(){var a="com-addc-fantethy-dev-edgware",b="http://localhost:63342",c=new WalletBar({dappNamespace:a,authServiceCallbackUrl:b});return console.log(JSON.stringify(c,null,4)),c}]);